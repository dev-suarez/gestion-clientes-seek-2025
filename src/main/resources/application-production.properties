# =====================================================
# Configuración para PRODUCCIÓN (GCP Cloud Run)
# =====================================================
# Perfil: production
# Uso: GCP Cloud Run con Cloud SQL
# Activación: SPRING_PROFILES_ACTIVE=production
# =====================================================

# Servidor optimizado para Cloud Run
server.port=${PORT:8080}

# Configuraciones de servidor para producción
server.tomcat.connection-timeout=300000
server.tomcat.keep-alive-timeout=300000
server.tomcat.max-connections=200
server.tomcat.threads.max=50
server.tomcat.threads.min-spare=10

# Base de datos Cloud SQL
spring.datasource.url=jdbc:mysql://google/client_management?cloudSqlInstance=${CLOUD_SQL_CONNECTION_NAME}&socketFactory=com.google.cloud.sql.mysql.SocketFactory&useSSL=false&serverTimezone=UTC
spring.datasource.username=${DB_USERNAME:root}
spring.datasource.password=${DB_PASSWORD}

# Pool de conexiones optimizado para Cloud Run
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000
spring.datasource.hikari.validation-timeout=5000

# Configuración JPA para producción
spring.jpa.show-sql=false
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.use_sql_comments=false
spring.jpa.properties.hibernate.generate_statistics=false

# JWT seguro para producción
app.jwt.secret=${JWT_SECRET}
app.jwt.expiration=${JWT_EXPIRATION:86400000}

# Logging para producción (integrado con Google Cloud Logging)
logging.level.com.desafio.clientes=INFO
logging.level.org.springframework=WARN
logging.level.org.hibernate=WARN
logging.level.org.flywaydb=INFO
logging.level.root=INFO

# No usar archivos de log en Cloud Run (usa Cloud Logging)
logging.file.name=

# Actuator limitado en producción por seguridad
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=never
management.endpoint.info.show-details=when_authorized

# Configuraciones específicas para Cloud Run
spring.main.lazy-initialization=true
spring.main.allow-bean-definition-overriding=false

# Compresión habilitada para mejor performance
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
server.compression.min-response-size=1024

# Configuración de seguridad para producción
server.error.include-stacktrace=never
server.error.include-message=never

# Configuración de timeout para Cloud Run
spring.transaction.default-timeout=300

# Configuración específica de Swagger para Cloud Run
server.forward-headers-strategy=framework
springdoc.swagger-ui.disable-swagger-default-url=true
springdoc.swagger-ui.use-root-path=true